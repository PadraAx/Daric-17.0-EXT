<?xml version='1.0' encoding='UTF-8' ?>
<odoo>

    <record id="hr_holiday_ext_leave_view_form" model="ir.ui.view">
        <field name="name">hr.leave.view.form</field>
        <field name="model">hr.leave</field>
        <field name="inherit_id" ref="hr_holidays.hr_leave_view_form"/>
        <field name="priority">150</field>
        <field name="arch" type="xml">   
            <xpath expr="//field[@name='holiday_status_id']" position="attributes">
                <attribute name="domain">[
                                '&amp;', 
                                ('leave_type', '!=', 'mission'), 
                                
                                    '|',
                                        ('requires_allocation', '=', 'no'),
                                        '&amp;',
                                            ('has_valid_allocation', '=', True),
                                            '&amp;',
                                                ('max_leaves', '>', '0'),
                                                '|',
                                                    ('allows_negative', '=', True),
                                                    '&amp;',
                                                        ('virtual_remaining_leaves', '&gt;', 0),
                                                        ('allows_negative', '=', False),
                                ]</attribute>
            </xpath>
            <xpath expr="//field[@name='request_unit_half']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='holiday_status_id']" position="after">
                <field name="approval_access" invisible="1"/>
            </xpath>
            <xpath expr="//div[hasclass('oe_edit_only')]" position="replace">
                <field name="status_leave_type" invisible="1"/>
                <div class="o_row o_row_readonly oe_edit_only" style="margin-left: -2px;" invisible="leave_type_request_unit == 'day'">
                    <field name="request_unit_half" class="oe_inline"
                           invisible="1"
                           readonly="state not in ('draft', 'confirm')" />
                    <label for="request_unit_half" 
                           invisible="1" />
                    <field name="request_unit_hours" 
                           invisible="leave_type_request_unit != 'hour'" 
                           readonly="state not in ('draft', 'confirm')" 
                           class="ms-5" />
                    <label for="request_unit_hours" invisible="leave_type_request_unit != 'hour'" />
                </div>
            </xpath>
            <xpath expr="//field[@name='request_hour_from']" position="attributes">
                <attribute name="widget">float_time</attribute>
            </xpath>
            <xpath expr="//field[@name='request_hour_to']" position="attributes">
                <attribute name="widget">float_time</attribute>
            </xpath>
        </field>
    </record>

    <record id="hr_holiday_ext_leave_form_manager" model="ir.ui.view">
        <field name="name">hr.holiday.ext.leave.form.manager</field>
        <field name="model">hr.leave</field>
        <field name="inherit_id" ref="hr_holidays.hr_leave_view_form_manager"/>
        <field name="priority">50</field>
        <field name="arch" type="xml">
            <xpath expr="//button[@name='action_approve']" position="attributes">
                <attribute name="invisible">not active or not can_approve or state != 'confirm' or status_leave_type == 'mission'</attribute>
            </xpath>
            <xpath expr="//button[@name='action_refuse']" position="attributes">
                <attribute name="invisible">not active or not can_approve or state not in ('confirm', 'validate1', 'validate') or status_leave_type == 'mission'</attribute>
            </xpath>
        </field>
    </record>

    <record id="hr_holiday_payroll_leave_form_inherit" model="ir.ui.view">
        <field name="name">hr.holiday.payroll.leave.form.inherit</field>
        <field name="model">hr.leave</field>
        <field name="inherit_id" ref="hr_payroll_holidays.hr_leave_view_form_inherit"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='payslip_state']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
        </field>
    </record>

    <record id="hr_leave_ext_view_tree_my" model="ir.ui.view">
        <field name="name">hr.holidays.ext.leave.view.tree</field>
        <field name="model">hr.leave</field>
        <field name="inherit_id" ref="hr_holidays.hr_leave_view_tree_my"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='all_employee_ids']" position="attributes">
                <attribute name="column_invisible">0</attribute>
            </xpath>
        </field>
    </record>

    <record id="hr_holiday_ext_leave_tree" model="ir.ui.view">
        <field name="name">hr.holidays.ext.leave.tree.management</field>
        <field name="model">hr.leave</field>
        <field name="inherit_id" ref="hr_holidays.hr_leave_view_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//button[@name='action_refuse']" position="attributes">
                <attribute name="groups">hr_holidays.group_hr_holidays_responsible</attribute>
            </xpath>
        </field>
    </record>

    <record id="time_off_ext_by_employee" model="ir.ui.view">
        <field name="name">time.off.ext.by.employee</field>
        <field name="model">hr.leave</field>
        <field name="inherit_id" ref="hr_holidays.view_holiday_list"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='state']" position="after">
                <field name="company_country_id"/>
            </xpath>
        </field>
    </record>

    <record id="hr_leave_ext_report_search" model="ir.ui.view">
        <field name="name">hr.leave.ext.report.search</field>
        <field name="inherit_id" ref="hr_holidays.hr_leave_report_search_view"/>
        <field name="model">hr.leave</field>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='name']" position="after">
                <field name="company_country_id"/>
            </xpath>
            <xpath expr="//group//filter[@name='group_company']" position="after">
                <filter name="company_country_id" string="Country" context="{'group_by':'company_country_id'}"/>
            </xpath>
        </field>
    </record>

    <record model="ir.actions.act_window" id="hr_holidays.hr_leave_action_action_approve_department">
        <field name="context">{'search_default_waiting_for_me': 1,
                                'search_default_waiting_for_me_manager': 2,
                                'hide_employee_name': 1,
                                'holiday_status_display_name': False,
                                'hr.leave.model': 1}
        </field>
        <field name="domain">[]</field>
    </record>

    <record id="hr_holidays.hr_leave_action_my" model="ir.actions.act_window">
        <field name="domain">[('user_id', '=', uid)]</field>
    </record>


    <record id="hr_holidays.action_manager_approval" model="ir.actions.server">
        <field name="groups_id" eval="[(4, ref('hr_holidays.group_hr_holidays_responsible'))]"/>
    </record>

    <record id="hr_holidays.action_hr_approval" model="ir.actions.server">
        <field name="groups_id" eval="[(4, ref('hr_holidays.group_hr_holidays_user'))]"/>
    </record>
    
</odoo>
<!-- 
    <record id="hr_holiday_ext_leave_view_form" model="ir.ui.view">
        <field name="name">hr.leave.view.form</field>
        <field name="model">hr.leave</field>
        <field name="priority">32</field>
        <field name="inherit_id" ref="hr_holidays.hr_leave_view_form"/>
        <field name="arch" type="xml">   
            <xpath expr="//group[@name='col_left']" position="replace">
                <group name="col_left">
                    <field name="employee_company_id" invisible="1"/>
                    <field name="holiday_status_id" force_save="1"
                        domain="[
                            '|',
                                ('requires_allocation', '=', 'no'),
                                '&amp;',
                                    ('has_valid_allocation', '=', True),
                                    '&amp;',
                                        ('max_leaves', '>', '0'),
                                        '|',
                                            ('allows_negative', '=', True),
                                            '&amp;',
                                                ('virtual_remaining_leaves', '&gt;', 0),
                                                ('allows_negative', '=', False),
                        ]"
                        context="{'employee_id': employee_id, 'default_date_from': date_from, 'default_date_to': date_to}"
                        options="{'no_create': True, 'no_open': True, 'request_type': 'leave'}"
                        readonly="state in ['cancel', 'refuse', 'validate', 'validate1']"/>
                    <field name="date_from" invisible="1"/>
                    <field name="date_to" invisible="1"/>
                    <field name="request_date_from" invisible="1"/>
                    <field name="request_date_to" invisible="1"/>
          
                    <label for="request_date_from" invisible="not request_unit_half and not request_unit_hours" string="Date" />
                    <label for="request_date_from" invisible="request_unit_half or request_unit_hours" string="Dates" />
                    <div class="o_row" invisible="not request_unit_half and not request_unit_hours">
                        <field name="request_date_from" class="oe_inline" string="Date" readonly="state not in ('draft', 'confirm')" />
                        <field name="request_date_from_period" invisible="not request_unit_half" required="request_unit_half"/>
                    </div>
                   
                    <div class="o_row" invisible="request_unit_half or request_unit_hours">
                        <field
                            name="request_date_from"
                            widget="daterange"
                            readonly="state not in ('draft', 'confirm')"
                            required="not date_from or not date_to"
                            options="{'end_date_field': 'request_date_to'}"/>
                        <field name="request_date_to" invisible="1" />
                    </div>
                    <label for="request_unit_half" string="" invisible="1" />
                    <div class="o_row o_row_readonly oe_edit_only" style="margin-left: -2px;" invisible="1"  >
                        <field name="request_unit_half" class="oe_inline" invisible="leave_type_request_unit == 'day'" readonly="state not in ('draft', 'confirm')" />
                        <label for="request_unit_half" invisible="leave_type_request_unit == 'day'" />
                        <field name="request_unit_hours" invisible="leave_type_request_unit != 'hour'" readonly="state not in ('draft', 'confirm')" class="ms-5" />
                        <label for="request_unit_hours" invisible="leave_type_request_unit != 'hour'" />
                    </div>
                    <label for="request_hour_from" string=""  />
                    <div class="o_row o_row_readonly"  >
                        <label for="request_hour_from" string="From" invisible="1" />
                        <field name="request_hour_from" invisible="1" readonly="state == 'validate'" required="request_unit_hours" />
                        <label for="request_hour_to" invisible="1" string="To" />
                        <field name="request_hour_to" invisible="1" readonly="state == 'validate'" required="request_unit_hours" />                      
                        <group>
                            <field name="req_hour_from"  readonly="state == 'validate'" required="request_unit_hours" widget="float_time"/>
                        </group>
                        <group>
                            <field name="req_hour_to"  readonly="state == 'validate'" required="request_unit_hours" widget="float_time"/>
                        </group>                       
                    </div>
                    <label for="number_of_hours_display" string="Duration" invisible="request_unit_half and leave_type_request_unit != 'hour'"/>
                    <div name="duration_display" invisible="request_unit_half and leave_type_request_unit != 'hour'">
                        <div>
                            <field name="number_of_hours_display" class="oe_inline" widget="float_time"/>
                        </div>
                    </div>
                    <field name="name" readonly="state not in ('draft', 'confirm')" widget="text" placeholder="Add a description..." />
                    <field name="user_id" invisible="1" />
                    <field name="leave_type_support_document" invisible="1" />
                    <label for="supported_attachment_ids" string="Supporting Document" invisible="not leave_type_support_document or state not in ('draft', 'confirm', 'validate1')" />
                    <field name="supported_attachment_ids" widget="many2many_binary" nolabel="1" invisible="not leave_type_support_document or state not in ('draft', 'confirm', 'validate1')" />
                </group>
            </xpath>
        </field>
    </record>
     -->